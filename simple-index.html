<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Moderation Pilot - Performance Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #f9fafb;
            padding: 2rem;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { margin-bottom: 2rem; }
        .header h1 { font-size: 2rem; color: #111827; margin-bottom: 0.5rem; }
        .header p { color: #6b7280; }
        
        .metrics { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1.5rem; margin-bottom: 2rem; }
        .metric-card { 
            background: white; 
            padding: 1.5rem; 
            border-radius: 0.5rem; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-left: 4px solid;
        }
        .metric-card.blue { border-left-color: #3b82f6; }
        .metric-card.red { border-left-color: #ef4444; }
        .metric-card.green { border-left-color: #10b981; }
        .metric-card.cyan { border-left-color: #06b6d4; }
        .metric-card.purple { border-left-color: #8b5cf6; }
        .metric-title { font-size: 0.875rem; color: #6b7280; margin-bottom: 0.5rem; font-weight: 500; }
        .metric-value { font-size: 2rem; font-weight: bold; color: #111827; margin-bottom: 0.25rem; }
        .metric-subtitle { font-size: 0.875rem; color: #9ca3af; }
        .metric-info { font-size: 0.75rem; color: #d1d5db; margin-top: 0.5rem; }
        
        .tabs-container { background: white; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        .tabs { display: flex; gap: 2rem; padding: 0 1.5rem; border-bottom: 1px solid #e5e7eb; flex-wrap: wrap; }
        .tab { 
            padding: 1rem 0.25rem; 
            font-size: 0.875rem; 
            font-weight: 500; 
            color: #6b7280;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }
        .tab:hover { color: #374151; border-bottom-color: #d1d5db; }
        .tab.active { color: #2563eb; border-bottom-color: #2563eb; }
        
        .tab-content { padding: 1.5rem; display: none; }
        .tab-content.active { display: block; }
        
        .chart-container { margin: 1.5rem 0; }
        canvas { max-height: 400px; }
        
        .info-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 1.5rem; }
        .info-grid.cols-4 { grid-template-columns: repeat(4, 1fr); }
        .info-box { 
            padding: 1rem; 
            border-radius: 0.5rem;
            border-left: 4px solid;
        }
        .info-box.blue { background: #eff6ff; border-left-color: #3b82f6; }
        .info-box.green { background: #f0fdf4; border-left-color: #10b981; }
        .info-box.purple { background: #faf5ff; border-left-color: #8b5cf6; }
        .info-box.yellow { background: #fefce8; border-left-color: #eab308; }
        .info-box.red { background: #fef2f2; border-left-color: #ef4444; }
        .info-box-title { font-size: 0.875rem; font-weight: 500; margin-bottom: 0.25rem; }
        .info-box-value { font-size: 1.5rem; font-weight: bold; }
        .info-box-subtitle { font-size: 0.75rem; margin-top: 0.25rem; color: #6b7280; }
        
        .alert { 
            padding: 1rem; 
            border-radius: 0.5rem; 
            border-left: 4px solid;
            margin-top: 1rem;
        }
        .alert.yellow { background: #fefce8; border-left-color: #eab308; }
        .alert.red { background: #fef2f2; border-left-color: #ef4444; }
        .alert.blue { background: #eff6ff; border-left-color: #3b82f6; }
        
        .summary { background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .summary h3 { margin-bottom: 1rem; font-size: 1.125rem; }
        .summary-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; }
        .summary-item { padding-left: 1rem; border-left: 4px solid; }
        .summary-item h4 { font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem; }
        .summary-item p { font-size: 0.875rem; color: #6b7280; line-height: 1.5; }
        
        h3 { font-size: 1.125rem; font-weight: 600; margin-bottom: 1rem; color: #111827; }
        h4 { font-size: 1rem; font-weight: 600; margin-bottom: 0.75rem; color: #111827; }
        
        .two-col-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; margin-top: 1.5rem; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>AI Moderation Performance Analysis</h1>
            <p>Detailed performance metrics and accuracy analysis ‚Ä¢ Aug 26 - Oct 3, 2025</p>
        </div>

        <div class="metrics">
            <div class="metric-card blue">
                <div class="metric-title">Total Projects Created</div>
                <div class="metric-value">688</div>
                <div class="metric-subtitle">In Salesforce</div>
            </div>
            <div class="metric-card purple">
                <div class="metric-title">Total Tickets Flagged</div>
                <div class="metric-value">453</div>
                <div class="metric-subtitle">65.8% flagging rate</div>
            </div>
            <div class="metric-card red">
                <div class="metric-title">False Positives</div>
                <div class="metric-value">216</div>
                <div class="metric-subtitle">47.7% of flagged</div>
            </div>
            <div class="metric-card green">
                <div class="metric-title">True Positives</div>
                <div class="metric-value">15</div>
                <div class="metric-subtitle">6.5% precision</div>
            </div>
        </div>

        <div class="tabs-container">
            <div class="tabs">
                <div class="tab active" onclick="showTab('daily-volume')">Daily Volume & Flagging</div>
                <div class="tab" onclick="showTab('keywords')">Keywords</div>
                <div class="tab" onclick="showTab('workflow')">Workflow Analysis</div>
                <div class="tab" onclick="showTab('false-positives')">False Positives</div>
                <div class="tab" onclick="showTab('true-positives')">True Positives</div>
            </div>

            <div id="daily-volume" class="tab-content active">
                <h3>Projects Created vs Tickets Flagged by Day</h3>
                <div class="chart-container">
                    <canvas id="dailyChart"></canvas>
                </div>
                
                <h4 style="margin-top: 2rem;">Daily Flagging Rate (%) - Aligned to Project Creation Date</h4>
                <div class="chart-container">
                    <canvas id="flaggingRateChart"></canvas>
                </div>
                
                <div class="info-grid cols-4">
                    <div class="info-box blue">
                        <div class="info-box-title">Overall Flagging Rate</div>
                        <div class="info-box-value">65.8%</div>
                        <div class="info-box-subtitle">453 / 688 projects</div>
                    </div>
                    <div class="info-box purple">
                        <div class="info-box-title">Average Flagging Rate</div>
                        <div class="info-box-value">85.7%</div>
                        <div class="info-box-subtitle">Aligned to project day</div>
                    </div>
                    <div class="info-box green">
                        <div class="info-box-title">Total Projects</div>
                        <div class="info-box-value">688</div>
                        <div class="info-box-subtitle">Across 38 days</div>
                    </div>
                    <div class="info-box red">
                        <div class="info-box-title">Days >100% Flagging</div>
                        <div class="info-box-value">8</div>
                        <div class="info-box-subtitle">Low-volume days</div>
                    </div>
                </div>
                
                <div class="alert blue">
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">‚ÑπÔ∏è Data Alignment Note</div>
                    <div style="font-size: 0.875rem;">
                        <strong>Flagging rates shown by project creation date:</strong> Since the AI script runs daily and analyzes the previous day's projects, we've aligned the data to show flagging rates for the day projects were actually created (not the day tickets were generated). This provides a more accurate view of how the AI performs on each day's content.<br><br>
                        ‚Ä¢ Example: 188 projects created on Sep 17 ‚Üí 128 tickets generated on Sep 18 ‚Üí Shown as <strong>68.1% flagging rate for Sep 17</strong><br>
                        ‚Ä¢ This alignment eliminates misleading spikes and provides meaningful day-over-day comparisons
                    </div>
                </div>
                
                <div class="alert yellow">
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">üìä Key Flagging Insights</div>
                    <div style="font-size: 0.875rem;">
                        After proper alignment, the data reveals:<br>
                        ‚Ä¢ <strong>Average daily flagging rate: 85.7%</strong> - significantly higher than overall 65.8% due to days with zero projects<br>
                        ‚Ä¢ <strong>Bulk import days:</strong> Sep 17 (68.1%) and Sep 29 (86.4%) show high but reasonable flagging rates<br>
                        ‚Ä¢ <strong>8 days with >100% flagging</strong> - mostly low-volume days (1-7 projects) where small variations create high percentages<br>
                        ‚Ä¢ <strong>Range:</strong> 7.7% (best day) to 500% (Sep 19: 5 tickets from 1 project - statistical outlier)
                    </div>
                </div>
            </div>

            <div id="keywords" class="tab-content">
                <h3>Most Frequently Flagged Keywords</h3>
                <div class="chart-container">
                    <canvas id="keywordsChart"></canvas>
                </div>
                <div class="info-grid" style="grid-template-columns: repeat(2, 1fr);">
                    <div class="info-box blue">
                        <div class="info-box-title">Most Common Triggers</div>
                        <div class="info-box-value">"event" & "member"</div>
                        <div class="info-box-subtitle">5 and 3 instances respectively</div>
                    </div>
                    <div class="info-box red">
                        <div class="info-box-title">Critical Finding</div>
                        <div class="info-box-subtitle">Only 27 tickets (6%) had keyword flags - most flagging is AI classification-based, not keyword-based</div>
                    </div>
                </div>
            </div>

            <div id="workflow" class="tab-content">
                <h3>Ticket Resolution Workflow Analysis</h3>
                <div class="chart-container">
                    <canvas id="workflowChart"></canvas>
                </div>
                <div class="alert red">
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">Critical Performance Metrics</div>
                    <div style="font-size: 0.875rem;">
                        ‚Ä¢ <strong>Precision: 6.5%</strong> (15 true positives out of 231 resolved tickets)<br>
                        ‚Ä¢ <strong>False Positive Rate: 47.7%</strong> (216 cases required no action)<br>
                        ‚Ä¢ <strong>True Positive Rate: 3.3%</strong> (only 15 cases confirmed violations)<br>
                        ‚Ä¢ The AI is currently over-flagging by a significant margin
                    </div>
                </div>
            </div>

            <div id="false-positives" class="tab-content">
                <h3>False Positive Deep Dive Analysis</h3>
                <div class="alert red" style="margin-top: 0;">
                    <div style="font-weight: 600;">False Positives: 216 (47.7% of flagged, 31.4% of all projects)</div>
                    <div style="font-size: 0.875rem; margin-top: 0.25rem;">Based on tickets that went directly to "Done" without manual review</div>
                </div>
                <div class="two-col-grid">
                    <div>
                        <h4>False Positives by Category</h4>
                        <canvas id="fpCategoryChart"></canvas>
                    </div>
                    <div>
                        <h4>False Positives by AI Confidence</h4>
                        <canvas id="fpConfidenceChart"></canvas>
                    </div>
                </div>
            </div>

            <div id="true-positives" class="tab-content">
                <h3>True Positive Deep Dive Analysis</h3>
                <div class="alert green" style="margin-top: 0;">
                    <div style="font-weight: 600;">Confirmed True Positives: 15 (3.3% of flagged, 2.2% of all projects)</div>
                    <div style="font-size: 0.875rem; margin-top: 0.25rem;">Tickets that went through manual review (In Progress ‚Üí Done workflow)</div>
                </div>
                <div class="two-col-grid">
                    <div>
                        <h4>True Positives by Category</h4>
                        <canvas id="tpCategoryChart"></canvas>
                    </div>
                    <div>
                        <h4>True Positives by AI Confidence</h4>
                        <canvas id="tpConfidenceChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div class="summary">
            <h3>Executive Summary: Key Performance Insights</h3>
            <div class="summary-grid">
                <div class="summary-item" style="border-left-color: #8b5cf6;">
                    <h4>Very High Flagging Volume</h4>
                    <p>65.8% of all projects (453/688) were flagged by the AI, with an average daily rate of 85.7%. This means on typical days, 4-9 out of every 10 projects trigger review, creating substantial manual workload.</p>
                </div>
                <div class="summary-item" style="border-left-color: #ef4444;">
                    <h4>Precision Crisis</h4>
                    <p>6.5% precision rate means 93.5% of flagged content is not actually violating policy. Of 453 flags, only 15 were true violations - a massive false positive problem.</p>
                </div>
                <div class="summary-item" style="border-left-color: #3b82f6;">
                    <h4>Daily Batch Processing</h4>
                    <p>AI script runs daily and processes previous day's projects. This creates a 24-hour delay between project creation and ticket generation, which is expected system behavior.</p>
                </div>
            </div>
            <div class="alert red">
                <div style="font-weight: 600; margin-bottom: 0.5rem;">‚ö†Ô∏è Recommendation: Do Not Scale</div>
                <div style="font-size: 0.875rem;">
                    Given the 6.5% precision rate and 65.8% overall flagging rate, this model requires significant improvement before production deployment. The high volume of false positives (216 cases) creates unsustainable review overhead. Consider: (1) comprehensive retraining with corrected labels, (2) raising confidence thresholds to 0.7+, (3) implementing mandatory human review for all flags, or (4) exploring alternative models/approaches.
                </div>
            </div>
        </div>
    </div>

    <script>
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // Daily Volume Chart - Projects vs Tickets
        new Chart(document.getElementById('dailyChart'), {
            type: 'line',
            data: {
                labels: ['26/Aug','27/Aug','28/Aug','29/Aug','30/Aug','31/Aug','01/Sep','02/Sep','03/Sep','04/Sep','05/Sep','06/Sep','07/Sep','08/Sep','09/Sep','10/Sep','11/Sep','12/Sep','13/Sep','14/Sep','15/Sep','16/Sep','17/Sep','18/Sep','19/Sep','20/Sep','21/Sep','22/Sep','23/Sep','24/Sep','25/Sep','26/Sep','27/Sep','28/Sep','29/Sep','30/Sep','01/Oct','02/Oct','03/Oct'],
                datasets: [{
                    label: 'Projects Created',
                    data: [17,6,5,6,7,2,9,15,13,8,2,2,5,7,14,9,8,6,2,4,5,7,188,5,1,4,6,21,13,5,3,3,1,40,214,11,9,5,0],
                    borderColor: '#3b82f6',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    tension: 0.4,
                    borderWidth: 2,
                    yAxisID: 'y'
                }, {
                    label: 'Tickets Flagged',
                    data: [2,5,1,0,1,0,1,0,0,1,6,0,0,0,5,3,6,2,4,2,6,6,8,128,3,5,3,7,12,9,6,1,5,1,4,185,20,2,3],
                    borderColor: '#8b5cf6',
                    backgroundColor: 'rgba(139, 92, 246, 0.1)',
                    tension: 0.4,
                    borderWidth: 2,
                    yAxisID: 'y'
                }]
            },
            options: { 
                responsive: true, 
                maintainAspectRatio: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Count' }
                    }
                },
                plugins: {
                    legend: { display: true },
                    tooltip: { mode: 'index', intersect: false }
                }
            }
        });

        // Flagging Rate Chart - REALIGNED to project creation date
        new Chart(document.getElementById('flaggingRateChart'), {
            type: 'bar',
            data: {
                labels: ['26/Aug','27/Aug','28/Aug','29/Aug','30/Aug','31/Aug','01/Sep','02/Sep','03/Sep','04/Sep','05/Sep','06/Sep','07/Sep','08/Sep','09/Sep','10/Sep','11/Sep','12/Sep','13/Sep','14/Sep','15/Sep','16/Sep','17/Sep','18/Sep','19/Sep','20/Sep','21/Sep','22/Sep','23/Sep','24/Sep','25/Sep','26/Sep','27/Sep','28/Sep','29/Sep','30/Sep','01/Oct','02/Oct','03/Oct'],
                datasets: [{
                    label: 'Flagging Rate (%) - Aligned to Project Day',
                    data: [29.4,16.7,0,16.7,0,50,0,0,7.7,75,0,0,0,71.4,21.4,66.7,25,66.7,100,150,120,114.3,68.1,60,500,75,116.7,57.1,69.2,120,33.3,166.7,100,10,86.4,181.8,22.2,60,0],
                    backgroundColor: function(context) {
                        const value = context.parsed.y;
                        if (value > 150) return '#ef4444'; // Red for >150%
                        if (value > 80) return '#f59e0b'; // Orange for 80-150%
                        if (value > 40) return '#eab308'; // Yellow for 40-80%
                        if (value > 0) return '#10b981'; // Green for 0-40%
                        return '#d1d5db'; // Gray for 0
                    }
                }]
            },
            options: { 
                responsive: true, 
                maintainAspectRatio: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Flagging Rate (%)' }
                    }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: { 
                        callbacks: {
                            label: function(context) {
                                const idx = context.dataIndex;
                                const dates = ['26/Aug','27/Aug','28/Aug','29/Aug','30/Aug','31/Aug','01/Sep','02/Sep','03/Sep','04/Sep','05/Sep','06/Sep','07/Sep','08/Sep','09/Sep','10/Sep','11/Sep','12/Sep','13/Sep','14/Sep','15/Sep','16/Sep','17/Sep','18/Sep','19/Sep','20/Sep','21/Sep','22/Sep','23/Sep','24/Sep','25/Sep','26/Sep','27/Sep','28/Sep','29/Sep','30/Sep','01/Oct','02/Oct','03/Oct'];
                                return 'Projects created ' + dates[idx] + ': ' + context.parsed.y.toFixed(1) + '% flagged';
                            }
                        }
                    }
                }
            }
        });

        // Keywords Chart
        new Chart(document.getElementById('keywordsChart'), {
            type: 'bar',
            data: {
                labels: ['event','member','sponsor','Raffle','events','membership','Payment','levy','Sponsorship','benefit','cap','Event','sponsorship','shirt','tickets'],
                datasets: [{
                    label: 'Count',
                    data: [5,3,3,2,2,2,2,1,1,1,1,1,1,1,1],
                    backgroundColor: '#06b6d4'
                }]
            },
            options: { responsive: true, maintainAspectRatio: true }
        });

        // Workflow Chart
        new Chart(document.getElementById('workflowChart'), {
            type: 'bar',
            data: {
                labels: ['Direct to Done','In Progress ‚Üí Done','Currently In Progress','Still in To Do'],
                datasets: [{
                    label: 'Count',
                    data: [216,15,39,183],
                    backgroundColor: ['#ef4444','#10b981','#f59e0b','#9ca3af']
                }]
            },
            options: { responsive: true, maintainAspectRatio: true }
        });

        // FP Category Chart
        new Chart(document.getElementById('fpCategoryChart'), {
            type: 'bar',
            data: {
                labels: ['Inducement','Membership/Fees','Ticketing/Admission','Sponsorship','Advertising','Personal Contact','Gambling'],
                datasets: [{
                    label: 'Count',
                    data: [197,190,181,166,161,153,5],
                    backgroundColor: '#ef4444'
                }]
            },
            options: { responsive: true, maintainAspectRatio: true, indexAxis: 'y' }
        });

        // FP Confidence Chart
        new Chart(document.getElementById('fpConfidenceChart'), {
            type: 'pie',
            data: {
                labels: ['0.8-1.0 (19%)','0.6-0.8 (42%)','0.4-0.6 (36%)','0.2-0.4 (4%)'],
                datasets: [{
                    data: [198,438,376,41],
                    backgroundColor: ['#ef4444','#f97316','#fbbf24','#84cc16']
                }]
            },
            options: { responsive: true, maintainAspectRatio: true }
        });

        // TP Category Chart
        new Chart(document.getElementById('tpCategoryChart'), {
            type: 'bar',
            data: {
                labels: ['Inducement','Membership/Fees','Advertising','Sponsorship','Ticketing/Admission','Personal Contact'],
                datasets: [{
                    label: 'Count',
                    data: [8,7,7,7,7,6],
                    backgroundColor: '#10b981'
                }]
            },
            options: { responsive: true, maintainAspectRatio: true, indexAxis: 'y' }
        });

        // TP Confidence Chart
        new Chart(document.getElementById('tpConfidenceChart'), {
            type: 'pie',
            data: {
                labels: ['0.8-0.9 (19%)','0.7-0.8 (17%)','0.6-0.7 (29%)','0.5-0.6 (31%)','0.4-0.5 (5%)'],
                datasets: [{
                    data: [8,7,12,13,2],
                    backgroundColor: ['#10b981','#34d399','#6ee7b7','#a7f3d0','#d1fae5']
                }]
            },
            options: { responsive: true, maintainAspectRatio: true }
        });
    </script>
</body>
</html>